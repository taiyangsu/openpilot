name: Sync Branch

on:
  schedule:
    - cron: '0 10 * * *'  # 每天 UTC 10 点运行
  workflow_dispatch:  # 允许手动触发

jobs:
  sync:
    runs-on: ubuntu-latest

    steps:
      # 1. Checkout the target repository (your repo)
      - name: Checkout the target repository (your repo)
        uses: actions/checkout@v3
        with:
          fetch-depth: 0  # 完整克隆仓库，确保所有历史记录
          token: ${{ secrets.GH_TOKEN }}  # 访问 GitHub 需要的令牌

      # 2. Add the source repositories as remotes and fetch branches
      - name: Add upstream repositories and fetch branches
        run: |
          git remote add upstream https://github.com/ajouatom/openpilot.git
          git fetch upstream carrot2-v9 --no-tags 
          
      # 3. Push v8-wip4 branch to your repository
      - name: Push carrot2-v9 branch to your repository
        run: |
          git checkout -B carrot2-v9 upstream/carrot2-v9
          git push origin carrot2-v9 --force
     
      - name: Add upstream repositories and fetch branches
        run: |
          git remote add upstream https://github.com/sunnypilot/sunnypilot.git
          git fetch upstream dev-c3-new --no-tags 
          
      # 3. Push dev-c3-new branch to your repository
      - name: Push dev-c3-new branch to your repository
        run: |
          git checkout -B dev-c3-new upstream/dev-c3-new
          git push origin dev-c3-new --force
          
